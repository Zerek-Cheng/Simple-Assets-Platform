"use strict";(self["webpackChunkelement"]=self["webpackChunkelement"]||[]).push([[443],{9835:(e,t,i)=>{i.r(t),i.d(t,{default:()=>n});var s=function(){var e=this,t=e._self._c;return t("el-row",[t("el-col",{attrs:{md:{span:16,push:4},xs:{span:22,push:1},id:"info"}},[t("PicInfo",{attrs:{pic:e.pic},on:{back:e.back}})],1)],1)},a=[];const o={props:["pic"],components:{PicInfo:()=>i.e(348).then(i.bind(i,9348))},name:"PicInfoView",methods:{back(){window.history.go(-1)}}},l=o;var r=i(3026),c=(0,r.Z)(l,s,a,!1,null,"b8b6d2fe",null);const n=c.exports},8654:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var s=function(){var e=this,t=e._self._c;return t("el-row",[t("el-col",{attrs:{md:{span:16,push:4},xs:{span:22,push:1},id:"upload-col"}},[t("el-card",{attrs:{id:"box-card"}},[t("el-col",{attrs:{slot:"header",id:"upload-card-header"},slot:"header"},[t("el-col",{staticStyle:{display:"inline-block",width:"auto","margin-right":"2em"}},[t("h1",[e._v("图片上传")])]),t("el-col",{attrs:{id:"upload-setting",xs:24,md:18}},[t("el-checkbox",{ref:"isPublic",attrs:{value:!0},model:{value:e.isPublic,callback:function(t){e.isPublic=t},expression:"isPublic"}},[e._v(" 公共可见 ")]),t("el-date-picker",{ref:"datetime",attrs:{type:"datetime",placeholder:"限时[可选]","time-arrow-control":!0},model:{value:e.dateLimit,callback:function(t){e.dateLimit=t},expression:"dateLimit"}}),t("el-input",{ref:"timesLimit",attrs:{placeholder:"限次[可选]",max:"10000",type:"number",id:"upload-setting-times-limit"},model:{value:e.timesLimit,callback:function(t){e.timesLimit=t},expression:"timesLimit"}},[t("template",{slot:"append"},[e._v("次")])],2)],1)],1),this.user?e._e():t("el-alert",{attrs:{id:"login-warn",title:"未登录",type:"error",description:"只有登录后才能上传图片，点击上方按钮登录","show-icon":""}}),t("el-divider"),t("el-upload",{ref:"upload",staticClass:"upload",attrs:{disabled:!e.user,action:"/api/upload","list-type":"picture","file-list":e.files,limit:10,"auto-upload":!1,"with-credentials":!0,headers:{"X-XSRF-TOKEN":e.csrf},"http-request":e.requestUpload,"on-success":e.onSuccess,"on-preview":e.onPreview,accept:".jpg,.jpeg,.png,.gif,.bmp,.webp,.svg,.tiff",drag:"",multiple:""}},[t("div",{staticClass:"el-upload__text"},[t("p",[t("i",{staticClass:"el-icon-upload"})]),e._v(" 将文件拖到此处，或"),t("em",[e._v("点击这里")])])]),this.user?t("el-button",{attrs:{type:"success",id:"confirm"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.confirmUpload.apply(null,arguments)}}},[e._v(" 确认上传 ")]):e._e()],1)],1)],1)},a=[],o=i(6294);const l={data:()=>({files:[],isPublic:!0,dateLimit:null,timesLimit:null}),computed:{...(0,o.mapState)(["user","csrf"])},beforeMount(){this.isPublic=void 0===this.$cookies.get("isPublic")||!!JSON.parse(this.$cookies.get("isPublic")),this.dateLimit=void 0===this.$cookies.get("dateLimit")?null:new Date(this.$cookies.get("dateLimit")),this.timesLimit=void 0===this.$cookies.get("timesLimit")?null:this.$cookies.get("timesLimit")},methods:{completeData(e){const t={};return t.isPublic=this.isPublic,t.file=e.file,this.dateLimit&&(t.dataLimit=this.dateLimit),this.timesLimit&&(t.timesLimit=this.timesLimit),t},confirmUpload(){this.$cookies.set("isPublic",this.$refs.isPublic.value),this.$refs.datetime.value?this.$cookies.set("dateLimit",this.$refs.datetime.value):this.$cookies.remove("dateLimit"),this.$refs.timesLimit.value&&this.$refs.timesLimit.value>100?this.$cookies.set("timesLimit",this.$refs.timesLimit.value):this.$cookies.remove("timesLimit"),this.$refs.upload.submit()},requestUpload(e){this.$axios.request({method:"post",url:e.action,headers:{"Content-Type":"multipart/form-data"},data:this.completeData(e)}).then((t=>e.onSuccess(t.data,e.file))).catch((t=>e.onError(t,e.file)))},onSuccess(e,t){-1===e.code&&(t.status="error",this.$message.error(e.message))},onPreview(e){e.response&&0===e.response.code&&window.open(this.$router.resolve({name:"pic-info",params:{pic:e.response.data.id}}).href)}}},r=l;var c=i(3026),n=(0,c.Z)(r,s,a,!1,null,"111774b4",null);const d=n.exports}}]);
//# sourceMappingURL=about-7f522a8a.js.map